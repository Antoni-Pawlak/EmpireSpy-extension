/*! For license information please see background.js.LICENSE.txt */
(()=>{var e={23889:(e,t,n)=>{e.exports=n(92397).default},92397:(e,t,n)=>{"use strict";t.default=h;var r,o=(r=n(29367))&&r.__esModule?r:{default:r},i="axios-retry";function s(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,o.default)(e)}var a=["get","head","options"],c=a.concat(["put","delete"]);function u(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function l(e){return!!e.config&&u(e)&&-1!==c.indexOf(e.config.method)}function d(e){return s(e)||l(e)}function f(){return 0}function p(e){var t=e[i]||{};return t.retryCount=t.retryCount||0,e[i]=t,t}function h(e,t){e.interceptors.request.use((function(e){return p(e).lastRequestTime=Date.now(),e})),e.interceptors.response.use(null,(function(n){var r=n.config;if(!r)return Promise.reject(n);var o=function(e,t){return Object.assign({},t,e[i])}(r,t),s=o.retries,a=void 0===s?3:s,c=o.retryCondition,u=void 0===c?d:c,l=o.retryDelay,h=void 0===l?f:l,y=o.shouldResetTimeout,v=void 0!==y&&y,m=p(r);if(u(n)&&m.retryCount<a){m.retryCount+=1;var g=h(m.retryCount,n);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,r),!v&&r.timeout&&m.lastRequestTime){var b=Date.now()-m.lastRequestTime;r.timeout=Math.max(r.timeout-b-g,1)}return r.transformRequest=[function(e){return e}],new Promise((function(t){return setTimeout((function(){return t(e(r))}),g)}))}return Promise.reject(n)}))}h.isNetworkError=s,h.isSafeRequestError=function(e){return!!e.config&&u(e)&&-1!==a.indexOf(e.config.method)},h.isIdempotentRequestError=l,h.isNetworkOrIdempotentRequestError=d,h.exponentialDelay=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=100*Math.pow(2,e),n=.2*t*Math.random();return t+n},h.isRetryableError=u},9669:(e,t,n)=>{e.exports=n(51609)},55448:(e,t,n)=>{"use strict";var r=n(64867),o=n(36026),i=n(15327),s=n(84109),a=n(67985),c=n(85061);e.exports=function(e){return new Promise((function(t,u){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",h=e.auth.password||"";d.Authorization="Basic "+btoa(p+":"+h)}if(f.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,u,r),f=null}},f.onerror=function(){u(c("Network Error",e,null,f)),f=null},f.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var y=n(4372),v=(e.withCredentials||a(e.url))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;v&&(d[e.xsrfHeaderName]=v)}if("setRequestHeader"in f&&r.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:f.setRequestHeader(t,e)})),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),u(e),f=null)})),void 0===l&&(l=null),f.send(l)}))}},51609:(e,t,n)=>{"use strict";var r=n(64867),o=n(91849),i=n(30321),s=n(45655);function a(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=a(s);c.Axios=i,c.create=function(e){return a(r.merge(s,e))},c.Cancel=n(65263),c.CancelToken=n(14972),c.isCancel=n(26502),c.all=function(e){return Promise.all(e)},c.spread=n(8713),e.exports=c,e.exports.default=c},65263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},14972:(e,t,n)=>{"use strict";var r=n(65263);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},26502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},30321:(e,t,n)=>{"use strict";var r=n(45655),o=n(64867),i=n(80782),s=n(13572);function a(e){this.defaults=e,this.interceptors={request:new i,response:new i}}a.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],(function(e){a.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}})),o.forEach(["post","put","patch"],(function(e){a.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=a},80782:(e,t,n)=>{"use strict";var r=n(64867);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},85061:(e,t,n)=>{"use strict";var r=n(80481);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},13572:(e,t,n)=>{"use strict";var r=n(64867),o=n(18527),i=n(26502),s=n(45655),a=n(91793),c=n(7303);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},80481:e=>{"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},36026:(e,t,n)=>{"use strict";var r=n(85061);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},18527:(e,t,n)=>{"use strict";var r=n(64867);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},45655:(e,t,n)=>{"use strict";var r=n(64867),o=n(16016),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(a=n(55448)),a),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(i)})),e.exports=c},91849:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},15327:(e,t,n)=>{"use strict";var r=n(64867);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var s=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),i=s.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,n)=>{"use strict";var r=n(64867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},91793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},67985:(e,t,n)=>{"use strict";var r=n(64867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},16016:(e,t,n)=>{"use strict";var r=n(64867);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},84109:(e,t,n)=>{"use strict";var r=n(64867),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}})),s):s}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},64867:(e,t,n)=>{"use strict";var r=n(91849),o=n(38778),i=Object.prototype.toString;function s(e){return"[object Array]"===i.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},38778:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},12096:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(9669),i=n(58575),s=n(1250),a=n(32238);function c(){return r(this,void 0,void 0,(function*(){try{const{data:e}=yield o.default.get("https://koala-inspector.koala-apps.io/api/link");e.link?yield s.default.set("aliAffLink",e.ali):yield s.default.clear("aliAffLink"),e.ebay?yield s.default.set("ebayAff",e.ebay):yield s.default.clear("ebayAff"),e.websites?yield s.default.set("siteView-websites",e.websites):yield s.default.clear("siteView-websites"),e.fiverr?yield s.default.set("fiverrAff",e.fiverr):yield s.default.clear("fiverrAff"),e.coinbase?yield s.default.set("coinbaseAff",e.coinbase):yield s.default.clear("coinbaseAff"),e.banggood?yield s.default.set("banggoodAff",e.banggood):yield s.default.clear("banggoodAff"),e.wallmart?yield s.default.set("wallmartAff",e.wallmart):yield s.default.clear("wallmartAff"),e.gearbest?yield s.default.set("gearbestAff",e.gearbest):yield s.default.clear("gearbestAff"),e.binance?yield s.default.set("binanceAff",e.binance):yield s.default.clear("binanceAff"),e.opensea?yield s.default.set("openseaAff",e.opensea):yield s.default.clear("openseaAff")}catch(e){console.error(e)}}))}function u(){return r(this,void 0,void 0,(function*(){try{yield s.default.set("exLinks",[]),yield function(){return r(this,void 0,void 0,(function*(){try{const{status:e}=yield o.default.get("http://www.smartredirect.de/redir/clickGate.php")}catch(e){throw e}}))}();const e=yield i.default.getExLinks();yield s.default.set("exLinks",e)}catch(e){console.error(e)}}))}chrome.runtime.onMessage.addListener(((e,t,n)=>{if("update-uninstall-url"==e.method){const t=e.url;chrome.runtime.setUninstallURL(t,(()=>{}))}else if("get-fb-ads"===e.method){const t=e.fbPageUrl;return a.fetchFacebookAds(t).then((e=>n({status:!0,data:e}))).catch((e=>{n({status:!1,data:e.message})})),!0}})),setInterval((()=>r(void 0,void 0,void 0,(function*(){yield c()}))),3e5),setInterval((()=>r(void 0,void 0,void 0,(function*(){yield u()}))),3e5),c(),u(),function(){r(this,void 0,void 0,(function*(){const e=yield function(){var e,t;return r(this,void 0,void 0,(function*(){const n=yield function(){return r(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{chrome.tabs.query({},(t=>{var n;const r=[];for(const e of t)(null===(n=e.url)||void 0===n?void 0:n.includes("hjbfbllnfhppnhjdhhbmjabikmkfekgf"))&&r.push({url:e.url,tab:e});e(r)}))}))}))}(),o=[];for(const r of n){const n=URLParse(r.url),i=null===(t=String(null!==(e=n.query)&&void 0!==e?e:""))||void 0===t?void 0:t.replace("?",""),s=queryString.parse(i);o.push(s)}const i=o.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{});return Object.keys(i).length>0?JSON.stringify(i):null}))}();e&&(yield s.default.set("install_ref",e))}))}(),chrome.runtime.onUpdateAvailable.addListener((()=>{chrome.runtime.reload()}))},32238:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFacebookAds=void 0;const o=n(84564),i=n(17563),s=n(9669);t.fetchFacebookAds=function(e){return r(this,void 0,void 0,(function*(){const t=yield function(e){return r(this,void 0,void 0,(function*(){try{const t=`https://m.facebook.com/${o(e).pathname.replace(/\//g,"")}`,n=yield s.default.get(t);if(n){const e=n.data.match(/page_id:(\d{1,})/g).map((e=>e.replace("page_id:",""))).find(Boolean);if(e)return e;throw new Error("Unable to find facebook page id")}throw new Error("Unable to find facebook page id")}catch(e){throw new Error("Unable to find facebook page id")}}))}(e),{sessionId:n,lsd:a}=yield function(e){return r(this,void 0,void 0,(function*(){const t=`https://www.facebook.com/ads/library/?active_status=all&ad_type=all&country=ALL&view_all_page_id=${e}&sort_data[direction]=desc&sort_data[mode]=relevancy_monthly_grouped&search_type=page&media_type=all`,{data:n}=yield s.default.get(t),r=n.match(/sessionId\"\:\"(.*?)\"/);if(!r)throw new Error("no session id");const o=r.map((e=>e.replace(/sessionId/g,"").replace(/\"/g,"").replace(/\:/g,""))).find(Boolean);if(!o)throw new Error("could not find session id");const i=n.match(/\["LSD",\[\],\{\"token\"\:(.*?),/);if(!i)throw new Error("no match for lsd");return{sessionId:o,lsd:i.map((e=>e.replace(/LSD/g,"").replace(/token/g,"").replace(/token/g,"").replace(/\"/g,"").replace(/\:/g,"").replace(/\[/g,"").replace(/\]/g,"").replace(/\{/g,"").replace(/\}/g,"").replace(/\,/g,""))).find(Boolean)}}))}(t);return yield function(e,t,n){return r(this,void 0,void 0,(function*(){const r=`https://www.facebook.com/ads/library/async/search_ads/?session_id=${t}&count=30&active_status=all&ad_type=all&countries[0]=ALL&view_all_page_id=${e}&media_type=all&search_type=page`,o={__user:"0",__a:"1",lsd:n},a=i.stringify(o),{data:c}=yield s.default.post(r,a,{headers:{"Content-Type":"application/x-www-form-urlencoded","x-fb-lsd":n}}),u=c.replace(/for \(\;\;\)\;/g,"");return JSON.parse(u).payload.results}))}(t,n,a)}))}},68275:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1250);t.default=class{static getChromeUserEmail(){return r(this,void 0,void 0,(function*(){return new Promise((e=>{var t;(null===(t=null===chrome||void 0===chrome?void 0:chrome.identity)||void 0===t?void 0:t.getProfileUserInfo)?chrome.identity.getProfileUserInfo((t=>{e(t.email)})):e(null)}))}))}static getUserEmail(){return r(this,void 0,void 0,(function*(){const e=yield o.default.get("userEmail");return e||(yield this.getChromeUserEmail())}))}static getManagedShops(){return r(this,void 0,void 0,(function*(){const e=yield o.default.get("shopsDataCache");try{return JSON.parse(window.atob(e))||[]}catch(e){return[]}}))}static getB64EncodedManagedShops(){return r(this,void 0,void 0,(function*(){const e=yield this.getManagedShops(),t=JSON.stringify(e);return window.btoa(t)}))}static saveManagedShops(e){return r(this,void 0,void 0,(function*(){const t=Array.from(new Set(e.map((e=>e.shopId)))).map((t=>e.find((e=>e.shopId===t)))),n=JSON.stringify(t),r=window.btoa(n);yield o.default.set("shopsDataCache",r)}))}static addManagedShop(e){return r(this,void 0,void 0,(function*(){try{const t=[...yield this.getManagedShops(),e];this.saveManagedShops(t)}catch(e){}}))}}},41665:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(9669),i=n(87742);t.default=class{static getKeenTracker(){return this.keenTracker||(this.keenTracker=new i.default({projectId:"5b5eecb0c9e77c00014ea7fa",writeKey:"4ABD7EAE58EF111CBB45A429CC46F26D2599F3A3BB8C9844EF6412C331BF6FA8E4AB02CCD13639946411B23CA8ACCB2EC5E50FBB92D05F22932C009BFAF5353F0C2067D9FEE0E72CC38B69588B634856B255B62D42178021077328A4A007AB6C"})),this.keenTracker}static trackCustomerio(e,t,n){const r=window.btoa("bd9f81ebdfb04a33d3f0:dfb9120ba3031385f492");this.userId&&o.default.post(`https://track.customer.io/api/v1/customers/${encodeURIComponent(this.userId)}/events`,{name:e,type:t,data:n},{headers:{Authorization:`Basic ${r}`,"Content-Type":"application/json"},maxRedirects:0}).catch((e=>{}))}static logEvent(e){}static logKeen(e){}static setUser(e){this.logEvent(`SetUser: ${e}`),this.userId=e}static pageView(e){this.safeKeenTrack("InApp-PageView",{page:e,userId:this.userId}),this.trackCustomerio("InApp-PageView","page",{page:e,userId:this.userId}),this.currentPage=e}static screenRecordIdentify(e,t){window.__insp.push(["tagSession",Object.assign({email:e},t)])}static dataView(e,t){var n;return r(this,void 0,void 0,(function*(){this.screenRecordIdentify(this.userId,{shop:e.name});const r=e.theme||{name:null,url:null},o=JSON.parse(JSON.stringify(t)),i={};for(const e of Object.keys(o)){const t=e.toLowerCase();(t.includes("enabled")||t.includes("capacity")||t.includes("used")||["myShopsCount","licenseExpiry","experiencePoints"].includes(e))&&(i[e]=o[e])}const s=null===(n=null==o?void 0:o.plans)||void 0===n?void 0:n.find((e=>e.id===(null==o?void 0:o.currentPlanId)));i.currentPlan=null==s?void 0:s.name;const a=Object.assign({user:this.userId,page:"DataView",windowPopupExpanded:e.windowPopupExpanded,windowPopupInfoCategory:e.windowPopupInfoCategory,shop:e.name,isShopify:e.isShopify,isLocked:e.lockedShop,themeName:r.name,themeUrl:r.url,trafficRank:e.trafficRank,appsCount:e.detectedApps.length,currency:e.shopCurrency},i);yield this.safeKeenTrack("InApp-DataView",a),this.trackCustomerio("InApp-DataView","dataview",a),console.log(a),this.currentViewedShop=a.shop}))}static keenTrack(e,t){return r(this,void 0,void 0,(function*(){return this.logKeen(Object.assign({event:e},t)),new Promise(((n,r)=>{this.getKeenTracker().recordEvent(e,t,((e,t)=>{e?r(e):n(t)}))}))}))}static safeKeenTrack(e,t){return r(this,void 0,void 0,(function*(){try{yield this.keenTrack(e,Object.assign(Object.assign({},t),{clientVersion:"2.32-PROD"}))}catch(e){}}))}static click(e,t={}){return r(this,void 0,void 0,(function*(){try{this.screenRecordIdentify(this.userId,Object.assign(Object.assign({btnClick:`button-${e}`},t),{page:this.currentPage}))}catch(e){}const n=Object.assign({button:e,page:this.currentPage,userId:this.userId},t);yield this.safeKeenTrack("InApp-Button-Click",n),this.trackCustomerio("InApp-Button-Click","click",n)}))}}},58575:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ApiEvent=void 0;const o=n(9669),i=n(23889),s=n(1250),a=n(68275),c=n(41665),u=n(84564);var l;!function(e){e.NOT_SUBSCRIBED="NOT_SUBSCRIBED",e.LOGGED_IN="LOGGED_IN",e.LOGIN_SERVER_ERROR="LOGIN_SERVER_ERROR",e.INVALIDATED="INVALIDATED"}(l=t.ApiEvent||(t.ApiEvent={}));class d{static setApiEvent(e){this.notifyApiEvent=e}static makeRequest(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken();return e.headers=Object.assign(Object.assign({},e.headers||{}),{token:t,"CLIENT-VERSION":this.clientVersion}),yield o.default(e)}))}static get(e,t={}){return r(this,void 0,void 0,(function*(){return t.method="get",t.url=e,yield this.makeRequest(t)}))}static post(e,t,n={}){return r(this,void 0,void 0,(function*(){return n.method="post",n.url=e,n.data=t,yield this.makeRequest(n)}))}static getSimilarProducts(e,t){return r(this,void 0,void 0,(function*(){const n=`${this.apiEndpoint}/findSimilarProducts`,r=yield this.getToken();try{const{data:i}=yield o.default.post(n,{imageUrl:e,productUrl:t},{headers:{token:r||"","CLIENT-VERSION":this.clientVersion}});return i}catch(e){return[]}}))}static getRef(){return r(this,void 0,void 0,(function*(){try{const e=yield s.default.get("install_ref");return JSON.parse(e)}catch(e){return null}}))}static trackInstall(e){return r(this,void 0,void 0,(function*(){const t=yield this.getRef(),n=t?`&${u.qs.stringify(t)}`:"",r=`${this.trackInstallUrl}?email=${encodeURIComponent(e)}${n}`;window.open(r)}))}static refreshUninstallUrl(){return r(this,void 0,void 0,(function*(){const e=yield s.default.get("userToken");e&&(this.uninstallUrl=`https://koala-inspector.koala-apps.io/uninstall?token=${e}`,chrome.runtime.sendMessage({method:"update-uninstall-url",url:this.uninstallUrl}))}))}static notify(e,t){this.notifyApiEvent&&this.notifyApiEvent(e,t)}static getEmail(){return s.default.get("userEmail")}static invalidateToken(){return r(this,void 0,void 0,(function*(){yield s.default.clearAll(),yield s.default.clearAll(!1),this.notify(l.INVALIDATED)}))}static getToken(){return r(this,void 0,void 0,(function*(){const e=yield s.default.get("userToken");return e?(yield this.refreshUninstallUrl(),e):this.regenerateToken()}))}static reloadCurrentWindow(){return r(this,void 0,void 0,(function*(){yield new Promise((e=>chrome.tabs.reload((()=>e()))))}))}static signIn(e){return r(this,void 0,void 0,(function*(){return!!(yield this.regenerateToken(null,null,e))}))}static subscribeUser(e,t,n){return r(this,void 0,void 0,(function*(){yield this.regenerateToken(e,t,n),yield this.trackInstall(e)}))}static openSupport(){return r(this,void 0,void 0,(function*(){const e=yield s.default.get("userEmail"),t=yield new Promise((e=>chrome.windows.getCurrent((t=>e(t)))));return new Promise((n=>{chrome.windows.create({type:"popup",url:`${this.supportEndpoint}?email=${e}`,height:472,width:351,left:t.left,top:t.top},(e=>{n(e)}))}))}))}static detectScript(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/detect?url=${encodeURIComponent(e)}`;try{return(yield o.default.get(n,{headers:{token:t||"","CLIENT-VERSION":this.clientVersion}})).data}catch(e){401===e.status&&this.notify(l.NOT_SUBSCRIBED)}}))}static detectW(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/wdetect?url=${encodeURIComponent(e)}`;try{return(yield o.default.get(n,{headers:{token:t||"","CLIENT-VERSION":this.clientVersion}})).data}catch(e){401===e.status&&this.notify(l.NOT_SUBSCRIBED)}}))}static cacheFeatureFlags(e){return r(this,void 0,void 0,(function*(){const t={trafficEnabled:e.trafficEnabled,exportCsvEnabled:e.exportCsvEnabled,partnersEnabled:e.partnersEnabled,adCampaignsEnabled:e.adCampaignsEnabled,favoritesEnabled:e.favoritesEnabled,gamificationEnabled:e.gamificationEnabled,autodsEnabled:e.autodsEnabled,googleAdsEnabled:e.googleAdsEnabled,facebookAdsEnabled:e.facebookAdsEnabled,windowPopupEnabled:e.windowPopupEnabled,notificationsEnabled:e.notificationsEnabled,allowNonShopifyOps:e.allowNonShopifyOps};yield s.default.set("user-feature-flags",t,!1)}))}static regenerateToken(e,t,n){return r(this,void 0,void 0,(function*(){const r=yield s.default.get("userEmail"),i=yield a.default.getB64EncodedManagedShops(),c=e||r;if(c){console.info("User email:",c);try{const{data:e}=yield o.default.post(`${this.apiEndpoint}/signup`,{email:c,newsletterOptIn:t,ssid:i},{headers:{"CLIENT-VERSION":this.clientVersion}});if(e.status){const{token:t,email:r}=e.data;return yield Promise.all([s.default.set("userToken",t),s.default.set("userEmail",r),this.cacheFeatureFlags(e.data)]),n&&Object.keys(e.data).forEach((t=>{"token"!==t&&(n[t]=e.data[t])})),yield this.refreshUninstallUrl(),this.notify(l.LOGGED_IN,e.data),t}throw e.error}catch(e){this.notify(l.LOGIN_SERVER_ERROR)}}else this.notify(l.NOT_SUBSCRIBED)}))}static isShopLocked(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/locked?shop=${encodeURIComponent(e)}`,{data:r}=yield o.default.get(n,{headers:{token:t,"CLIENT-VERSION":this.clientVersion}});if(r.status)return r.data.locked;throw r.error}))}static getMyShops(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/myShops`,{data:n}=yield o.default.get(t,{headers:{token:e,"CLIENT-VERSION":this.clientVersion}});return n}))}static trackShop(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/trackShop`,{data:r}=yield o.default.post(n,{shop:e},{headers:{token:t,"CLIENT-VERSION":this.clientVersion}})}))}static getFeaturedApps(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/featuredApps`,{data:n}=yield o.default.get(t,{headers:{token:e,"CLIENT-VERSION":this.clientVersion}});return n.data}))}static untrackShop(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/untrackShop`,{data:r}=yield o.default.post(n,{shop:e},{headers:{token:t,"CLIENT-VERSION":this.clientVersion}});if(r.status)return!0;throw r.error}))}static setTrackingShopNotificationStatus(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.getToken(),r=`${this.apiEndpoint}/setTrackingShopNotificationStatus`,{data:i}=yield o.default.post(r,{shop:e,notificationStatus:t},{headers:{token:n,"CLIENT-VERSION":this.clientVersion}});if(i.status)return!0;throw i.error}))}static getShopFeed(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.getToken(),r=`${this.apiEndpoint}/shopFeed?shop=${encodeURIComponent(e)}&lastId=${encodeURIComponent(t)}`,{data:i}=yield o.default.get(r,{headers:{token:n,"CLIENT-VERSION":this.clientVersion}});if(i.status)return i.data;throw i.error}))}static getTrafficData(e){var t;return r(this,void 0,void 0,(function*(){const n=`${this.apiEndpoint}/traffic`;try{const{data:r}=yield this.get(n,{params:{shopUrl:e}});return null!==(t=null==r?void 0:r.data)&&void 0!==t?t:null}catch(e){return null}}))}static doUpgradeRequest(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/upgrade`,{data:r}=yield o.default.post(n,{plan:e},{headers:{token:t,"CLIENT-VERSION":this.clientVersion}});return r}))}static upgrade(e,t){return r(this,void 0,void 0,(function*(){const n=yield this.doUpgradeRequest(e);if(!n.status)throw new Error("Could not upgrade plan, please contact support");if(!n.requiresCheckout)return t.currentPlanId=n.currentPlan,yield c.default.click("AUTO-UPGRADE"),!0;yield c.default.click("CHECKOUT"),window.open(n.checkoutUrl)}))}static openTrackShopLearnMoreUrl(){return r(this,void 0,void 0,(function*(){window.open(this.trackShopLearnMoreUrl)}))}static getShopCreateAffiliateLink(){return new Promise((e=>{const t=()=>r(this,void 0,void 0,(function*(){const n=yield s.default.get("shopCreateAffiliateLink");n?e(n):setTimeout((()=>{t()}),500)}));t()}))}static verifyAndIncrementCsvCredit(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/csvCredit`,{data:n}=yield o.default.post(t,{},{headers:{token:e,"CLIENT-VERSION":this.clientVersion}});return n.status?(yield s.default.set("csvCreditsUsed",n.data),n.data):null}))}static getActivePartners(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/partners`;try{const{data:n}=yield o.default.get(t,{headers:{token:e,"CLIENT-VERSION":this.clientVersion}});return n.data}catch(e){return[]}}))}static getFacebookAds(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/facebookAds`,r=o.default.create();i(r,{retries:1,retryCondition:()=>!0});const{data:s}=yield r.get(n,{headers:{token:t,"CLIENT-VERSION":this.clientVersion},params:{facebookUrl:e}});if(s.data)return s.data;throw new Error("Facebook ads retrieval failed")}))}static getGoogleAds(e){return r(this,void 0,void 0,(function*(){const t=yield this.getToken(),n=`${this.apiEndpoint}/googleAds`,{data:r}=yield o.default.get(n,{headers:{token:t,"CLIENT-VERSION":this.clientVersion},params:{siteUrl:e}});if(r.data)return r.data;throw new Error("Google ads retrieval failed")}))}static fetchNotifications(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/notifications`,{data:n}=yield o.default.get(t,{headers:{token:e,"CLIENT-VERSION":this.clientVersion},params:{}});if(n.data)return n.data;throw new Error("Google ads retrieval failed")}))}static gamificationAction(e){return r(this,void 0,void 0,(function*(){const t=`${this.apiEndpoint}/gamificationAction`,{data:n}=yield this.post(t,{actionType:e});return n.data}))}static autodsAddProduct(e){return r(this,void 0,void 0,(function*(){try{const t=`${this.apiEndpoint}/autods/addProduct`;return yield this.post(t,e),!0}catch(e){return!1}}))}static autodsSignin(){return r(this,void 0,void 0,(function*(){const e=yield this.getToken(),t=`${this.apiEndpoint}/autods/signin?${u.qs.stringify({token:e})}`;window.open(t)}))}static getExLinks(){return r(this,void 0,void 0,(function*(){return(yield this.get(`${this.apiEndpoint}/aglink`)).data.data}))}}t.default=d,d.apiEndpoint="https://koala-inspector.koala-apps.io/api",d.supportEndpoint="https://koala-inspector.koala-apps.io/statics/supportPopup.html",d.trackInstallUrl="https://koala-inspector.koala-apps.io/post-install",d.uninstallUrl="https://koala-inspector.koala-apps.io/uninstall",d.trackShopLearnMoreUrl="https://koala-inspector.koala-apps.io/tracking-learn-more",d.clientVersion="2.32-PROD"},1250:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static getAll(e=!0){return n(this,void 0,void 0,(function*(){return new Promise((t=>{(e?chrome.storage.sync:chrome.storage.local).get((e=>{t(e)}))}))}))}static get(e,t=!0){return n(this,void 0,void 0,(function*(){return new Promise((n=>{(t?chrome.storage.sync:chrome.storage.local).get([e],(t=>{n(t[e])}))}))}))}static set(e,t,r=!0,o=!1){return n(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{(r?chrome.storage.sync:chrome.storage.local).set({[e]:t},(()=>{const e=chrome.runtime.lastError;e?o?i(e):n(e):n(null)}))}))}))}static clear(e,t=!0){return n(this,void 0,void 0,(function*(){return new Promise((n=>{(t?chrome.storage.sync:chrome.storage.local).set({[e]:null},(()=>{n()}))}))}))}static clearAll(e=!0){return n(this,void 0,void 0,(function*(){(e?chrome.storage.sync:chrome.storage.local).clear()}))}}},44020:e=>{"use strict";var t="%[a-f0-9]{2}",n=new RegExp(t,"gi"),r=new RegExp("("+t+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],o(n),o(r))}function i(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=o(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var o=i(n[0]);o!==n[0]&&(t[n[0]]=o)}n=r.exec(e)}t["%C2"]="�";for(var s=Object.keys(t),a=0;a<s.length;a++){var c=s[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},92806:e=>{"use strict";e.exports=function(e,t){for(var n={},r=Object.keys(e),o=Array.isArray(t),i=0;i<r.length;i++){var s=r[i],a=e[s];(o?-1!==t.indexOf(s):t(s,a,e))&&(n[s]=a)}return n}},29367:e=>{"use strict";var t=["ETIMEDOUT","ECONNRESET","EADDRINUSE","ESOCKETTIMEDOUT","ECONNREFUSED","EPIPE","EHOSTUNREACH","EAI_AGAIN"],n=["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED"];e.exports=function(e){return!e||!e.code||-1!==t.indexOf(e.code)||-1===n.indexOf(e.code)}},87742:e=>{var t;window,t=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=45)}([function(e,t){e.exports=function(e,t,n){var r;if(!e)return 0;if(n=n||e,e instanceof Array){for(r=0;r<e.length;r++)if(!1===t.call(n,e[r],r,e))return 0}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(n,e[r],r,e))return 0;return 1}},function(e,t){e.exports=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e}},function(e,t,n){"use strict";n.r(t),function(e){var t=n(19),r=n(5),o=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();o.Promise?o.Promise.prototype.finally||(o.Promise.prototype.finally=r.a):o.Promise=t.a}.call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.configDefault={queue:{capacity:5e3,interval:15},retry:{limit:10,initialDelay:200,retryOnResponseStatuses:[408,500,502,503,504]},unique:!1,cache:{dbName:"keenTracking",dbCollectionName:"events",dbCollectionKey:"hash",maxAge:6e4}};t.default=r},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.a=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))}},function(e,t){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,i="ArrayBuffer"in e;if(i)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};h.prototype.append=function(e,t){e=d(e),t=f(t);var n=this.map[e];this.map[e]=n?n+","+t:t},h.prototype.delete=function(e){delete this.map[d(e)]},h.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},h.prototype.set=function(e,t){this.map[d(e)]=f(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},n&&(h.prototype[Symbol.iterator]=h.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},b.call(w.prototype),b.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];_.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=h,e.Request=w,e.Response=_,e.fetch=function(e,t){return new Promise((function(n,o){var i=new w(e,t),s=new XMLHttpRequest;s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}})),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;n(new _(o,r))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&r&&(s.responseType="blob"),i.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),s.send(void 0===i._bodyInit?null:i._bodyInit)}))},e.fetch.polyfill=!0}function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function y(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function m(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(o&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(i&&r&&a(e))this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=y(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var e,t,n,r=y(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=v(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n,r,o=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),u.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function E(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},function(e){e.exports={name:"keen-tracking",version:"4.5.2",description:"Track events - custom user actions, clicks, pageviews, purchases.",main:"dist/node/keen-tracking.js",browser:"dist/keen-tracking.js",repository:{type:"git",url:"https://github.com/keen/keen-tracking.js.git"},scripts:{start:"NODE_ENV=development webpack-dev-server",test:"NODE_ENV=test jest && npm run test:node","test:node":"NODE_ENV=test TEST_ENV=node jest","test:watch":"NODE_ENV=test jest --watch","test:node:watch":"NODE_ENV=test TEST_ENV=node jest --watch",build:"NODE_ENV=production webpack -p && NODE_ENV=production OPTIMIZE_MINIMIZE=1 webpack -p && npm run build:node","build:node":"TARGET=node NODE_ENV=production webpack -p",profile:"webpack --profile --json > stats.json",analyze:"webpack-bundle-analyzer stats.json /dist",preversion:"npm run build:node && npm run test",version:"npm run build && git add .",postversion:"git push && git push --tags && npm publish",demo:"node ./test/demo/index.node.js"},bugs:"https://github.com/keen/keen-tracking.js/issues",author:"Keen IO <team@keen.io> (https://keen.io/)",homepage:"https://keen.io",keywords:["Tracking","Tracker","Event Tracker","Event tracking","Track events","Page tracking","User tracking","Analytics event tracking","Analytics events","Analytics tracking","Custom events","Analytics","Stats","Statistics","Monitoring","Metrics","Pageviews","Segmentation","Funnel","Conversion","Log","Logger","Logging","Javascript events","Universal tracking","Click analytics"],contributors:["Dustin Larimer <dustin@keen.io> (https://github.com/dustinlarimer)","Eric Anderson <eric@keen.io> (https://github.com/aroc)","Joe Wegner <joe@keen.io> (http://www.wegnerdesign.com)","Alex Kleissner <alex@keen.io> (https://github.com/hex337)","Adam Kasprowicz <adam.kasprowicz@keen.io> (https://github.com/adamkasprowicz)","Dariusz Łacheta <dariusz.lacheta@keen.io> (https://github.com/dariuszlacheta)"],license:"MIT",dependencies:{"component-emitter":"^1.2.0","js-cookie":"2.1.0","keen-core":"^0.1.3","promise-polyfill":"^8.0.0","whatwg-fetch":"^2.0.4"},devDependencies:{"babel-core":"^6.26.3","babel-jest":"^23.0.1","babel-loader":"^7.1.5","babel-plugin-transform-es2015-modules-commonjs":"^6.26.2","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-polyfill":"^6.26.0","babel-preset-env":"^1.7.0","babel-preset-es2015":"^6.24.1","babel-preset-stage-0":"^6.24.1",eslint:"^4.19.1","eslint-config-airbnb":"^16.1.0","eslint-loader":"^2.0.0","eslint-plugin-import":"^2.11.0","eslint-plugin-jsx-a11y":"^6.0.3","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0",jest:"^22.4.3","jest-fetch-mock":"^1.6.5",merge:"^1.2.1",nock:"^9.2.6","regenerator-runtime":"^0.11.1","replace-in-file":"^3.4.0","url-parse":"^1.4.3",webpack:"^4.5.0","webpack-bundle-analyzer":"^3.3.2","webpack-cli":"^2.0.13","webpack-dev-server":"^3.1.14","xhr-mock":"^2.3.2"}}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(43)),o=(a(n(0)),a(n(1)),n(18)),i=n(17),s=a(n(7));function a(e){return e&&e.__esModule?e:{default:e}}r.default.helpers=r.default.helpers||{},r.default.prototype.observers=r.default.observers||{},r.default.on("client",(function(e){e.extensions={events:[],collections:{}},e.config.respectDoNotTrack||(this.doNotTrack=!1),void 0!==e.config.optOut&&((0,i.setOptOut)(e.config.optOut),this.optedOut=e.config.optOut),e.queue=(0,o.queue)(e.config.queue),e.queue.on("flush",(function(){e.recordDeferredEvents()}))})),r.default.prototype.writeKey=function(e){return arguments.length?(this.config.writeKey=e?String(e):null,this):this.config.writeKey},r.default.prototype.referrerPolicy=function(e){return arguments.length?(this.config.referrerPolicy=e?String(e):null,this):this.config.referrerPolicy},r.default.prototype.setGlobalProperties=function(e){return r.default.log("This method has been removed. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events"),this},r.default.version=s.default.version,t.default=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomNodePath=function(e){if(!e.nodeName)return"";for(var t=[];null!=e.parentNode;){for(var n=0,r=0,o=0;o<e.parentNode.childNodes.length;o++){var i=e.parentNode.childNodes[o];i.nodeName==e.nodeName&&(i===e&&(r=n),n++)}e.hasAttribute("id")&&""!=e.id?t.unshift(e.nodeName.toLowerCase()+"#"+e.id):n>1?t.unshift(e.nodeName.toLowerCase()+":eq("+r+")"):t.unshift(e.nodeName.toLowerCase()),e=e.parentNode}return t.slice(1).join(" > ")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowProfile=function(){var e,t,n;return"undefined"==typeof document?{}:(e=document.body||{},t=document.documentElement||{},n={height:"innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,width:"innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth,scrollHeight:Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)||null},window.screen&&(n.ratio={height:window.screen.availHeight?parseFloat((window.innerHeight/window.screen.availHeight).toFixed(2)):null,width:window.screen.availWidth?parseFloat((window.innerWidth/window.screen.availWidth).toFixed(2)):null}),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScreenProfile=function(){var e,t;if("undefined"==typeof window||!window.screen)return{};e=["height","width","colorDepth","pixelDepth","availHeight","availWidth"],t={};for(var n=0;n<e.length;n++)t[e[n]]=window.screen[e[n]]?window.screen[e[n]]:null;return t.orientation={angle:window.screen.orientation?window.screen.orientation.angle:0,type:window.innerWidth>window.innerHeight?"landscape":"portrait"},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.MD5=function(e){return function(e){for(var t,n="0123456789ABCDEF",r="",o=0;o<e.length;o++)t=e.charCodeAt(o),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}(function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,r=-271733879,o=-1732584194,l=271733878,d=0;d<e.length;d+=16){var f=n,p=r,h=o,y=l;r=c(r=c(r=c(r=c(r=a(r=a(r=a(r=a(r=s(r=s(r=s(r=s(r=i(r=i(r=i(r=i(r,o=i(o,l=i(l,n=i(n,r,o,l,e[d+0],7,-680876936),r,o,e[d+1],12,-389564586),n,r,e[d+2],17,606105819),l,n,e[d+3],22,-1044525330),o=i(o,l=i(l,n=i(n,r,o,l,e[d+4],7,-176418897),r,o,e[d+5],12,1200080426),n,r,e[d+6],17,-1473231341),l,n,e[d+7],22,-45705983),o=i(o,l=i(l,n=i(n,r,o,l,e[d+8],7,1770035416),r,o,e[d+9],12,-1958414417),n,r,e[d+10],17,-42063),l,n,e[d+11],22,-1990404162),o=i(o,l=i(l,n=i(n,r,o,l,e[d+12],7,1804603682),r,o,e[d+13],12,-40341101),n,r,e[d+14],17,-1502002290),l,n,e[d+15],22,1236535329),o=s(o,l=s(l,n=s(n,r,o,l,e[d+1],5,-165796510),r,o,e[d+6],9,-1069501632),n,r,e[d+11],14,643717713),l,n,e[d+0],20,-373897302),o=s(o,l=s(l,n=s(n,r,o,l,e[d+5],5,-701558691),r,o,e[d+10],9,38016083),n,r,e[d+15],14,-660478335),l,n,e[d+4],20,-405537848),o=s(o,l=s(l,n=s(n,r,o,l,e[d+9],5,568446438),r,o,e[d+14],9,-1019803690),n,r,e[d+3],14,-187363961),l,n,e[d+8],20,1163531501),o=s(o,l=s(l,n=s(n,r,o,l,e[d+13],5,-1444681467),r,o,e[d+2],9,-51403784),n,r,e[d+7],14,1735328473),l,n,e[d+12],20,-1926607734),o=a(o,l=a(l,n=a(n,r,o,l,e[d+5],4,-378558),r,o,e[d+8],11,-2022574463),n,r,e[d+11],16,1839030562),l,n,e[d+14],23,-35309556),o=a(o,l=a(l,n=a(n,r,o,l,e[d+1],4,-1530992060),r,o,e[d+4],11,1272893353),n,r,e[d+7],16,-155497632),l,n,e[d+10],23,-1094730640),o=a(o,l=a(l,n=a(n,r,o,l,e[d+13],4,681279174),r,o,e[d+0],11,-358537222),n,r,e[d+3],16,-722521979),l,n,e[d+6],23,76029189),o=a(o,l=a(l,n=a(n,r,o,l,e[d+9],4,-640364487),r,o,e[d+12],11,-421815835),n,r,e[d+15],16,530742520),l,n,e[d+2],23,-995338651),o=c(o,l=c(l,n=c(n,r,o,l,e[d+0],6,-198630844),r,o,e[d+7],10,1126891415),n,r,e[d+14],15,-1416354905),l,n,e[d+5],21,-57434055),o=c(o,l=c(l,n=c(n,r,o,l,e[d+12],6,1700485571),r,o,e[d+3],10,-1894986606),n,r,e[d+10],15,-1051523),l,n,e[d+1],21,-2054922799),o=c(o,l=c(l,n=c(n,r,o,l,e[d+8],6,1873313359),r,o,e[d+15],10,-30611744),n,r,e[d+6],15,-1560198380),l,n,e[d+13],21,1309151649),o=c(o,l=c(l,n=c(n,r,o,l,e[d+4],6,-145523070),r,o,e[d+11],10,-1120210379),n,r,e[d+2],15,718787259),l,n,e[d+9],21,-343485551),n=u(n,f),r=u(r,p),o=u(o,h),l=u(l,y)}return Array(n,r,o,l)}(function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}(e),8*e.length))).toLowerCase()};function o(e,t,n,r,o,i){return u(function(e,t){return e<<t|e>>>32-t}(u(u(t,e),u(r,i)),o),n)}function i(e,t,n,r,i,s,a){return o(t&n|~t&r,e,t,i,s,a)}function s(e,t,n,r,i,s,a){return o(t&r|n&~r,e,t,i,s,a)}function a(e,t,n,r,i,s,a){return o(t^n^r,e,t,i,s,a)}function c(e,t,n,r,i,s,a){return o(n^(t|~r),e,t,i,s,a)}function u(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){return JSON.parse(JSON.stringify(e))}t.deepExtend=function e(t){for(var n=1;n<arguments.length;n++)if(t instanceof Array&&arguments[n]instanceof Array)for(var i=0;i<arguments[n].length;i++)t.indexOf(arguments[n][i])<0&&t.push(arguments[n][i]);else for(var s in arguments[n])void 0!==t[s]&&"object"===r(t[s])&&"object"===r(arguments[n][s])&&null!==arguments[n][s]?e(t[s],o(arguments[n][s])):void 0!==arguments[n][s]&&"function"!=typeof arguments[n][s]&&(t[s]=o(arguments[n][s]));return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.extendEvent=function(e,t){if(2===arguments.length&&"string"==typeof e&&("object"===(void 0===t?"undefined":r(t))||"function"==typeof t))return this.extensions.collections[e]=this.extensions.collections[e]||[],this.extensions.collections[e].push(t),this.emit("extendEvent",e,t),this;a.call(this,"Incorrect arguments provided to #extendEvent method")},t.extendEvents=function(e){if(1===arguments.length&&("object"===(void 0===e?"undefined":r(e))||"function"==typeof e))return this.extensions.events.push(e),this.emit("extendEvents",e),this;a.call(this,"Incorrect arguments provided to #extendEvents method")},t.getExtendedEventBody=function(e,t){return t&&t.length>0&&(0,s.default)(t,(function(t,n){var r="function"==typeof t?t():t;(0,i.deepExtend)(e,r)})),e};var o,i=n(14),s=(o=n(0))&&o.__esModule?o:{default:o};function a(e){this.emit("error","Event(s) not extended: "+e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLocalStorageAvailable=function(){var e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOptOut=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r.isLocalStorageAvailable&&(e?localStorage.setItem("optout",e):localStorage.removeItem("optout"))};var r=n(16)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.queue=a;var o=s(n(8)),i=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this instanceof a==0?new a(e):(this.capacity=0,this.config=r({},i.default.queue,e),this.events={},this.interval=0,this.timer=null,this)}(0,o.default)(a.prototype),a.prototype.check=function(){return((e=this).capacity>0&&e.interval>=e.config.interval||e.capacity>=e.config.capacity)&&this.flush(),0!==this.config.interval&&0!==this.capacity||this.pause(),this;var e},a.prototype.flush=function(){return this.emit("flush"),this.interval=0,this},a.prototype.pause=function(){return this.timer&&(clearInterval(this.timer),this.timer=null),this},a.prototype.start=function(){var e=this;return e.pause(),e.timer=setInterval((function(){e.interval++,e.check()}),1e3),e}},function(e,t,n){"use strict";(function(e){var r=n(5),o=setTimeout;function i(){}function s(e){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function a(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,s._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void u(t.promise,e)}c(t.promise,r)}else(1===e._state?c:u)(t.promise,e._value)}))):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof s)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void f((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,l(e)}catch(t){u(e,t)}var r,o}function u(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&s._immediateFn((function(){e._handled||s._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)a(e,e._deferreds[t]);e._deferreds=null}function d(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1;try{e((function(e){n||(n=!0,c(t,e))}),(function(e){n||(n=!0,u(t,e))}))}catch(e){if(n)return;n=!0,u(t,e)}}s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){var n=new this.constructor(i);return a(this,new d(e,t,n)),n},s.prototype.finally=r.a,s.all=function(e){return new s((function(t,n){if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,(function(t){i(e,t)}),n)}r[e]=s,0==--o&&t(r)}catch(e){n(e)}}for(var s=0;s<r.length;s++)i(s,r[s])}))},s.resolve=function(e){return e&&"object"==typeof e&&e.constructor===s?e:new s((function(t){t(e)}))},s.reject=function(e){return new s((function(t,n){n(e)}))},s.race=function(e){return new s((function(t,n){for(var r=0,o=e.length;r<o;r++)e[r].then(t,n)}))},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){o(e,0)},s._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},t.a=s}).call(this,n(38).setImmediate)},function(e,t,n){"use strict";function r(e){return this instanceof r==0?new r(e):(this.count=e||0,this)}Object.defineProperty(t,"__esModule",{value:!0}),t.timer=r,r.prototype.start=function(){var e=this;return this.pause(),this.interval=setInterval((function(){e.count++}),1e3),this},r.prototype.pause=function(){return clearInterval(this.interval),this},r.prototype.value=function(){return this.count},r.prototype.clear=function(){return this.count=0,this}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.serializeForm=function(e,t){"object"!=(void 0===t?"undefined":r(t))?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var n=t.hash?{}:"",s=t.serializer||(t.hash?c:u),a=e&&e.elements?e.elements:[],l=Object.create(null),d=0;d<a.length;++d){var f=a[d];if(!(t.ignoreTypes&&t.ignoreTypes.indexOf(f.type)>-1)&&(t.disabled||!f.disabled)&&f.name&&i.test(f.nodeName)&&!o.test(f.type)){var p=f.name,h=f.value;if("checkbox"!==f.type&&"radio"!==f.type||f.checked||(h=void 0),t.empty){if("checkbox"!==f.type||f.checked||(h=""),"radio"===f.type&&(l[f.name]||f.checked?f.checked&&(l[f.name]=!0):l[f.name]=!1),null==h&&"radio"==f.type)continue}else if(!h)continue;if("select-multiple"!==f.type)n=s(n,p,h);else{h=[];for(var y=f.options,v=!1,m=0;m<y.length;++m){var g=y[m],b=t.empty&&!g.value,w=g.value||b;g.selected&&w&&(v=!0,n=t.hash&&"[]"!==p.slice(p.length-2)?s(n,p+"[]",g.value):s(n,p,g.value))}!v&&t.empty&&(n=s(n,p,""))}}}if(t.empty)for(var p in l)l[p]||(n=s(n,p,""));return n};var o=/^(?:submit|button|image|reset|file)$/i,i=/^(?:input|select|textarea|keygen)/i,s=/(\[[^\[\]]*\])/g;function a(e,t,n){if(0===t.length)return n;var r=t.shift(),o=r.match(/^\[(.+?)\]$/);if("[]"===r)return e=e||[],Array.isArray(e)?e.push(a(null,t,n)):(e._values=e._values||[],e._values.push(a(null,t,n))),e;if(o){var i=o[1],s=+i;isNaN(s)?(e=e||{})[i]=a(e[i],t,n):(e=e||[])[s]=a(e[s],t,n)}else e[r]=a(e[r],t,n);return e}function c(e,t,n){if(t.match(s))a(e,function(e){var t=[],n=new RegExp(s),r=/^([^\[\]]*)/.exec(e);for(r[1]&&t.push(r[1]);null!==(r=n.exec(e));)t.push(r[1]);return t}(t),n);else{var r=e[t];r?(Array.isArray(r)||(e[t]=[r]),e[t].push(n)):e[t]=n}return e}function u(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=(n=encodeURIComponent(n)).replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}},function(e,t,n){var r,o;void 0===(o="function"==typeof(r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,o,i){var s;if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}try{s=JSON.stringify(o),/^[\{\[]/.test(s)&&(o=s)}catch(e){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,i.expires&&"; expires="+i.expires.toUTCString(),i.path&&"; path="+i.path,i.domain&&"; domain="+i.domain,i.secure?"; secure":""].join("")}t||(s={});for(var c=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var d=c[l].split("="),f=d[0].replace(u,decodeURIComponent),p=d.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{if(p=n.read?n.read(p,f):n(p,f)||p.replace(u,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(t===f){s=p;break}t||(s[f]=p)}catch(e){}}return s}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}((function(){}))})?r.call(t,n,t,e):r)||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cookie=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=s(n(22)),i=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var a=t.cookie=function e(t){if(arguments.length)return this instanceof e==0?new e(t):(this.config={key:t,options:{expires:365}},this.data=this.get(),this)};a.prototype.get=function(e){var t={};return o.default.get(this.config.key)&&(t=o.default.getJSON(this.config.key)),e&&"object"===(void 0===t?"undefined":r(t))&&null!==typeof t?void 0!==t[e]?t[e]:null:t},a.prototype.set=function(e,t,n){return arguments.length&&this.enabled()?("string"==typeof e&&arguments.length>=2?this.data[e]=t||null:"object"===(void 0===e?"undefined":r(e))&&1===arguments.length&&(0,i.default)(this.data,e),o.default.set(this.config.key,this.data,(0,i.default)(this.config.options,n||{})),this):this},a.prototype.expire=function(e){return e?o.default.set(this.config.key,this.data,(0,i.default)(this.config.options,{expires:e})):(o.default.remove(this.config.key),this.data={}),this},a.prototype.options=function(e){return arguments.length?(this.config.options="object"===(void 0===e?"undefined":r(e))?e:{},this):this.config.options},a.prototype.enabled=function(){return navigator.cookieEnabled}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueId=function(){return"undefined"!=typeof crypto&&crypto.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})):"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getScrollState=function(e){var t="object"===(void 0===e?"undefined":r(e))?e:{},n=(0,i.default)({pixel:0,pixel_max:0,ratio:null,ratio_max:null},t);return void 0===("undefined"==typeof window?"undefined":r(window))&&void 0===("undefined"==typeof document?"undefined":r(document))||(n.pixel=(void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop)+(window.innerHeight||document.documentElement.clientHeight),n.pixel>n.pixel_max&&(n.pixel_max=n.pixel),n.ratio=parseFloat(Number(n.pixel/s()).toFixed(2)),n.ratio_max=parseFloat(Number(n.pixel_max/s()).toFixed(2))),n};var o,i=(o=n(1))&&o.__esModule?o:{default:o};function s(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomNodeProfile=function(e){return{action:e.action,class:e.className,href:o(e,"href"),id:o(e,"id"),event_key:o(e,"data-event-key"),method:e.method,name:e.name,node_name:e.nodeName,selector:(0,r.getDomNodePath)(e),text:o(e,"text"),title:o(e,"title"),type:e.type,x_position:e.offsetLeft||e.clientLeft||null,y_position:e.offsetTop||e.clientTop||null}};var r=n(10),o=function e(t,n){return t[n]?t[n]:t.hasAttribute&&t.hasAttribute(n)?t.getAttribute(n):t.parentNode?e(t.parentNode,n):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainName=function(e){var t=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e),n=t.split("."),r=n.length;return r>2&&(t=n[r-2]+"."+n[r-1],2==n[r-2].length&&2==n[r-1].length&&(t=n[r-3]+"."+t)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDatetimeIndex=function(e){var t=e||new Date;return{hour_of_day:t.getHours(),day_of_week:parseInt(1+t.getDay()),day_of_month:t.getDate(),month:parseInt(1+t.getMonth()),year:t.getFullYear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserProfile=function(){return{cookies:void 0!==navigator.cookieEnabled&&navigator.cookieEnabled,codeName:navigator.appCodeName,description:(document&&"function"==typeof document.querySelector&&(e=document.querySelector('meta[name="description"]')),e?e.content:""),language:navigator.language,name:navigator.appName,online:navigator.onLine,platform:navigator.platform,useragent:navigator.userAgent,version:navigator.appVersion,doNotTrack:navigator.doNotTrack,screen:(0,r.getScreenProfile)(),window:(0,o.getWindowProfile)()};var e};var r=n(12),o=n(11)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.initAutoTrackingCore=function(e){return function(t){var n=this,o=e.helpers,c=e.utils,u=c.extend({ignoreDisabledFormFields:!1,ignoreFormFieldTypes:["password"],recordClicks:!0,recordClicksPositionPointer:!1,recordFormSubmits:!0,recordPageViews:!0,recordPageViewsOnExit:!1,recordScrollState:!0,shareUuidAcrossDomains:!1,collectIpAddress:!0,collectUuid:!0,recordElementViews:!0,catchError:void 0},t);if("beaconAPI"===n.config.requestType&&u.catchError)throw"You cannot use the BeaconAPI and catchError function in the same time, because BeaconAPI ignores errors. For requests with error handling - use requestType: 'fetch'";"jsonp"===n.config.requestType&&(u.catchError?n.config.requestType="fetch":n.config.requestType="beaconAPI");var l=new Date,d=0,f=0;if("undefined"!=typeof document){var p=void 0,h=void 0;void 0!==document.hidden?(p="hidden",h="visibilitychange"):void 0!==document.msHidden?(p="msHidden",h="msvisibilitychange"):void 0!==document.webkitHidden&&(p="webkitHidden",h="webkitvisibilitychange"),void 0===document.addEventListener&&void 0===p||document.addEventListener(h,(function(){if(document[p])return d+=s(l),void(f+=a(l));l=new Date}),!1)}var y=new c.cookie("keen"),v=o.getDomainName(window.location.hostname),m=v&&u.shareUuidAcrossDomains?{domain:"."+v}:{},g=void 0;u.collectUuid&&((g=y.get("uuid"))||(g=o.getUniqueId(),y.set("uuid",g,m)));var b=y.get("initialReferrer");b||(b=document&&document.referrer||void 0,y.set("initialReferrer",b,m));var w={};u.recordScrollState&&(w=o.getScrollState(),c.listener("window").on("scroll",(function(){w=o.getScrollState(w)})));var E=[{name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"tech"},{name:"keen:url_parser",input:{url:"url.full"},output:"url.info"},{name:"keen:url_parser",input:{url:"referrer.full"},output:"referrer.info"},{name:"keen:date_time_parser",input:{date_time:"keen.timestamp"},output:"time.utc"},{name:"keen:date_time_parser",input:{date_time:"local_time_full"},output:"time.local"}];if(E.push({name:"keen:ip_to_geo",input:{ip:"ip_address",remove_ip_property:!u.collectIpAddress},output:"geo"}),n.extendEvents((function(){var e=o.getBrowserProfile();return{tracked_by:i.default.name+"-"+i.default.version,local_time_full:(new Date).toISOString(),user:{uuid:g},page:{title:document?document.title:null,description:e.description,scroll_state:w,time_on_page:d>0?d:s(l),time_on_page_ms:f>0?f:a(l)},ip_address:"${keen.ip}",geo:{},user_agent:"${keen.user_agent}",tech:{profile:e},url:{full:window?window.location.href:"",info:{}},referrer:{initial:b,full:document?document.referrer:"",info:{}},time:{local:{},utc:{}},keen:{timestamp:(new Date).toISOString(),addons:E}}})),!0===u.recordClicks&&c.listener("a, a *").on("click",(function(e){var t=e.target,i={element:o.getDomNodeProfile(t),local_time_full:(new Date).toISOString()};if(!0===u.recordClicksPositionPointer){var s={x_position:e.pageX,y_position:e.pageY};i=r({},i,{pointer:s})}return u.catchError?n.recordEvent({collection:"clicks",event:i}).catch((function(e){u.catchError(e)})):n.recordEvent({collection:"clicks",event:i})})),!0===u.recordFormSubmits&&c.listener("form").on("submit",(function(e){var t=e.target,r={disabled:u.ignoreDisabledFormFields,ignoreTypes:u.ignoreFormFieldTypes},i={form:{action:t.action,fields:c.serializeForm(t,r),method:t.method},element:o.getDomNodeProfile(t),local_time_full:(new Date).toISOString()};return u.catchError?n.recordEvent({collection:"form_submissions",event:i}).catch((function(e){u.catchError(e)})):n.recordEvent({collection:"form_submissions",event:i})})),!0!==u.recordPageViews||u.recordPageViewsOnExit||(u.catchError?n.recordEvent({collection:"pageviews"}).catch((function(e){u.catchError(e)})):n.recordEvent({collection:"pageviews"})),u.recordPageViewsOnExit&&"undefined"!=typeof window&&window.addEventListener("beforeunload",(function(){n.config.requestType="beaconAPI",n.recordEvent({collection:"pageviews"})})),!0===u.recordElementViews&&"undefined"!=typeof IntersectionObserver){var _=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){var t={element:o.getDomNodeProfile(e.target),local_time_full:(new Date).toISOString()};return u.catchError?n.recordEvent({collection:"element_views",event:t}).catch((function(e){u.catchError(e)})):n.recordEvent({collection:"element_views",event:t})}}))}),{threshold:1});document.querySelectorAll(".track-element-view").forEach((function(e){_.observe(e)})),n.observers.IntersectionObserver=_}return n}};var o,i=(o=n(7))&&o.__esModule?o:{default:o};function s(e){return Math.round(a(e)/1e3)}function a(e){return(new Date).getTime()-e.getTime()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.deferEvent=function(e,t){if(2===arguments.length&&"string"==typeof e)return this.queue.events[e]=this.queue.events[e]||[],this.queue.events[e].push(t),this.queue.capacity++,this.queue.timer||this.queue.start(),this.emit("deferEvent",e,t),this;c.call(this,"Incorrect arguments provided to #deferEvent method")},t.deferEvents=function(e){var t=this;if(1===arguments.length&&"object"===(void 0===e?"undefined":o(e)))return(0,i.default)(e,(function(e,n){t.queue.events[n]=t.queue.events[n]||[],t.queue.events[n]=t.queue.events[n].concat(e),t.queue.capacity=t.queue.capacity+e.length,t.queue.timer||t.queue.start()})),t.emit("deferEvents",e),t;c.call(this,"Incorrect arguments provided to #deferEvents method")},t.queueCapacity=function(e){return arguments.length?(this.queue.config.capacity=e?Number(e):0,this.queue.check(),this):this.queue.config.capacity},t.queueInterval=function(e){return arguments.length?(this.queue.config.interval=e?Number(e):0,this.queue.check(),this):this.queue.config.interval},t.recordDeferredEvents=function(){var e=this;if(e.queue.capacity>0){e.queue.pause();var t=r({},e.queue.config),n=r({},e.queue.events);e.queue=(0,s.queue)(),e.queue.config=t,e.queue.on("flush",(function(){e.recordDeferredEvents()})),e.emit("recordDeferredEvents",n),e.recordEvents(n,(function(t,r){t&&e.emit("recordDeferredEventsError",t,n)}))}return e},a(n(9));var i=a(n(0)),s=n(18);function a(e){return e&&e.__esModule?e:{default:e}}function c(e){this.emit("error","Event(s) not deferred: "+e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFromCache=t.saveToCache=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(2),n(6),i(n(13));var o=i(n(3));function i(e){return e&&e.__esModule?e:{default:e}}"undefined"==typeof self&&console.log("IndexedDB is available only in Browser ENV");var s="undefined"!=typeof self&&"indexedDB"in self,a=!0;s||(a=!1);var c=void 0,u=r({},o.default.cache);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c?Promise.resolve():a?(u=r({},u,e),new Promise((function(e,t){var n=self.indexedDB.open(u.dbName);n.onerror=function(t){a=!1,e()},n.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(u.dbCollectionName,{keyPath:u.dbCollectionKey});t.createIndex(u.dbCollectionKey,u.dbCollectionKey,{unique:!0}),t.createIndex("expiryTime","expiryTime",{unique:!1})},n.onsuccess=function(t){(c=t.target.result).onerror=function(e){a=!1},e(c)}}))):Promise.resolve()}t.saveToCache=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(t).then((function(){var t=c.transaction(u.dbCollectionName,"readwrite").objectStore(u.dbCollectionName).add({hash:e,expiryTime:Date.now()+u.maxAge});t.onsuccess=function(e){},t.onerror=function(e){a=!1}}))},t.getFromCache=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(n).then((function(){return new Promise((function(r,o){if(!a)return r(null);var i=c.transaction(u.dbCollectionName,"readwrite").objectStore(u.dbCollectionName).index("expiryTime"),s=IDBKeyRange.upperBound(Date.now(),!0);i.openCursor(s).onsuccess=function(e){var t=e.target.result;t&&(c.transaction(u.dbCollectionName,"readwrite").objectStore(u.dbCollectionName).delete(e.target.result.value[u.dbCollectionKey]),t.continue())};var l=c.transaction(u.dbCollectionName,"readwrite").objectStore(u.dbCollectionName).index(u.dbCollectionKey).get(t);l.onsuccess=function(o){if(!o.target.result||o.target.result.expiryTime<Date.now()){if(o.target.result&&o.target.result.expiryTime<Date.now()){var i=c.transaction(u.dbCollectionName,"readwrite").objectStore(u.dbCollectionName).delete(o.target.result[u.dbCollectionKey]);return i.onsuccess=function(o){r(e(t,n))},i.onerror=function(o){a=!1,r(e(t,n))},r(null)}return r(null)}return r(o.target.result)},l.onerror=function(o){a=!1,r(e(t,n))}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n(2);var o=a(n(13)),i=n(32),s=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}var c=[],u=t.isUnique=function(e,t){var n=r({},s.default.cache,e.cache),a=JSON.stringify(t),u=n.hashingMethod,l=u&&"md5"===u.toLowerCase()?(0,o.default)(a):a,d=n.maxAge?Date.now()+n.maxAge:void 0,f={hash:l,expiryTime:d};if(d){var p=Date.now();c=c.filter((function(e){return e.expiryTime>p}))}var h=c.find((function(e){return e.hash===l}));if(h){if(!(h.expiryTime&&h.expiryTime<Date.now()))return Promise.resolve(!1);c=c.filter((function(e){return e.hash!==l}))}return c.push(f),n.storage&&"indexeddb"===n.storage.toLowerCase()?(0,i.getFromCache)(l,n).then((function(e){return!e&&((0,i.saveToCache)(l,n),!0)})):Promise.resolve(!0)};t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e,t){var n=r({},i.default,t.retry||{}),o=n.retry.limit,s=n.retry.initialDelay,a=n.retry.retryOnResponseStatuses,c=0;if(a&&!(a instanceof Array))throw{name:"ArgumentError",message:"retryOn property expects an array"};return new Promise((function(n,r){var i=function(o){fetch(e,t).then((function(e){-1===a.indexOf(e.status)?n(e):o>0?u():r(e)})).catch((function(e){o>0?u():r(e)}))};function u(){c+=1,setTimeout((function(){i(o-c)}),2^c*s)}i(o-c)}))},n(2),n(6);var o,i=(o=n(3))&&o.__esModule?o:{default:o}},function(e,t){e.exports={map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){"use strict";var t,n,r,o,i,s,a,c="",u=0,l=this.map;for(e=this.utf8.encode(e);u<e.length;)t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),o=t>>2,i=(3&t)<<4|n>>4,s=isNaN(n)?64:(15&n)<<2|r>>6,a=isNaN(n)||isNaN(r)?64:63&r,c=c+l.charAt(o)+l.charAt(i)+l.charAt(s)+l.charAt(a);return c},decode:function(e){"use strict";var t,n,r,o,i,s,a="",c=0,u=this.map,l=String.fromCharCode;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=u.indexOf(e.charAt(c++)),i=(15&(n=u.indexOf(e.charAt(c++))))<<4|(r=u.indexOf(e.charAt(c++)))>>2,s=(3&r)<<6|(o=u.indexOf(e.charAt(c++))),a=a+(l(t<<2|n>>4)+(64!=r?l(i):""))+(64!=o?l(s):"");return this.utf8.decode(a)},utf8:{encode:function(e){"use strict";for(var t,n="",r=0,o=String.fromCharCode;r<e.length;)n+=(t=e.charCodeAt(r++))<128?o(t):t>127&&t<2048?o(t>>6|192)+o(63&t|128):o(t>>12|224)+o(t>>6&63|128)+o(63&t|128);return n},decode:function(e){"use strict";for(var t,n="",r=0,o=String.fromCharCode;r<e.length;)n+=(t=e.charCodeAt(r))<128?[o(t),r++][0]:t>191&&t<224?[o((31&t)<<6|63&e.charCodeAt(r+1)),r+=2][0]:[o((15&t)<<12|(63&e.charCodeAt(r+1))<<6|63&(c3=e.charCodeAt(r+2))),r+=3][0];return n}}}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var e=a(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new h(e,t)),1!==u.length||l||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,s,a,c=1,u={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){h(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(s="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&h(+t.data.slice(s.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),r=function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){h(e.data)},r=function(e){i.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(h,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return u[c]=o,r(c),c++},f.clearImmediate=p}function p(e){delete u[e]}function h(e){if(l)setTimeout(h,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(4),n(36))},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(37),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.recordEvent=function e(t,n,i){var s=this,u=t,d=void 0,p=void 0;this.config,"object"===(void 0===t?"undefined":o(t))&&t&&(p=t,u=t.collection||t.event_collection,n=t.event,i=t.callback,d=t.unique);var y=this.url("events",encodeURIComponent(u)),v={};if(m.call(this,i)){if(u&&"string"==typeof u){(0,a.default)(v,n);var b={};return(0,l.getExtendedEventBody)(b,this.extensions.events),(0,l.getExtendedEventBody)(b,this.extensions.collections[u]),(0,l.getExtendedEventBody)(b,[v]),d?(0,f.default)(p,b).then((function(n){return n?e.call(s,r({},t,{unique:void 0})):Promise.resolve({created:!1,message:"[NOT_UNIQUE] This event has already been recorded"})})):(this.emit("recordEvent",u,b),c.default.enabled?c.default.optedOut?Promise.resolve({created:!1,message:"Keen.optedOut is set to true."}):c.default.doNotTrack?Promise.resolve({created:!1,message:"Keen.doNotTrack is set to true."}):h.call(this,{url:y,extendedEventsHash:b,callback:i,configObject:p,eventCollection:u}):(g.call(this,"Keen.enabled is set to false.",i),!1))}g.call(this,"Collection name must be a string.",i)}},t.recordEvents=function(e,t){var n=this,r=this.url("events");if(m.call(this,t))if("object"!==(void 0===e?"undefined":o(e))||e instanceof Array)g.call(this,"First argument must be an object",t);else{if(!(arguments.length>2)){var i={};return(0,s.default)(e,(function(e,t){i[t]=i[t]||[],(0,s.default)(e,(function(e,r){var o={};(0,l.getExtendedEventBody)(o,n.extensions.events),(0,l.getExtendedEventBody)(o,n.extensions.collections[t]),(0,l.getExtendedEventBody)(o,[e]),i[t].push(o)}))})),this.emit("recordEvents",i),c.default.enabled?c.default.optedOut?Promise.resolve({created:!1,message:"Keen.optedOut is set to true."}):c.default.doNotTrack?Promise.resolve({created:!1,message:"Keen.doNotTrack is set to true."}):h.call(this,{url:r,extendedEventsHash:i,callback:t}):(g.call(this,"Keen.enabled is set to false.",t),!1)}g.call(this,"Incorrect arguments provided to #recordEvents method",t)}},n(2),n(6);var i=p(n(35)),s=p(n(0)),a=p(n(1)),c=p(n(9)),u=n(7),l=n(15),d=p(n(34)),f=p(n(33));function p(e){return e&&e.__esModule?e:{default:e}}function h(e){var t=e.url,n=e.extendedEventsHash,r=e.callback,o=e.configObject,s=void 0===o?{}:o,a=e.eventCollection,c=(this.config,s.requestType||this.config.requestType);if(navigator&&navigator.sendBeacon&&"beaconAPI"===c)return navigator.sendBeacon(t+"?api_key="+this.writeKey(),JSON.stringify(n)),r&&r(),this;if("beacon"===c||"img"===c){var u=this.url("events",encodeURIComponent(a),{api_key:this.writeKey(),data:encodeURIComponent(i.default.encode(JSON.stringify(n))),modified:(new Date).getTime()});return u.length<("undefined"!=typeof window&&navigator&&(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)?1900:16e3)?b.call(this,u,r):r&&r("Beacon URL length exceeds current browser limit, and XHR is not supported.",null),this}return"undefined"!=typeof fetch?y.call(this,"POST",t,n,r):this}function y(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=this;return(0,d.default)(t,{method:e,body:n?JSON.stringify(n):"",mode:"cors",redirect:"follow",referrerPolicy:o.referrerPolicy()||"unsafe-url",headers:{Authorization:o.writeKey(),"Content-Type":"application/json","keen-sdk":"javascript-"+u.version},retry:o.config.retry}).catch((function(e){return void 0!==r&&r.call(o,e,null),o.emit("error",e),Promise.reject(e)})).then((function(e){return e.ok?e.json():e.json().then((function(t){return Promise.reject({error_code:t.error_code,body:t.message,status:e.status,ok:!1,statusText:e.statusText})}))})).then((function(e){return v(e)?(void 0!==r&&r.call(o,null,e),Promise.resolve(e)):(void 0!==r&&r.call(o,e,null),o.emit("error",e),Promise.reject(e))}))}function v(e){return void 0!==e.created?!!e.created:0===Object.keys(e).map((function(t){return e[t].filter((function(e){return!e.success}))})).filter((function(e){return e.length>0})).length}function m(e){return this.projectId()?!!this.writeKey()||(g.call(this,"Keen.Client is missing a writeKey property.",e),!1):(g.call(this,"Keen.Client is missing a projectId property.",e),!1)}function g(e,t){var n="Event(s) not recorded: "+e;this.emit("error",n),t&&t.call(this,n,null)}function b(e,t){var n=this,r=document.createElement("img");r.onload=function(){if("naturalHeight"in this){if(this.naturalHeight+this.naturalWidth===0)return void this.onerror()}else if(this.width+this.height===0)return void this.onerror();t&&t.call(n)},r.onerror=function(){t&&t.call(n,"An error occurred!",null)},r.src=e+"&c=clv1"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listenerCore=void 0,o(n(8));var r=o(n(0));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){document.addEventListener?document.addEventListener(e,t,!1):document.attachEvent("on"+e,t)}t.listenerCore=function(e){function t(e){if(e)return this instanceof t==0?new t(e):(this.selector=e,this)}function n(t){return function(n){var o,i;o=n||window.event,i=o.target||o.srcElement,"undefined"!==e.domListeners[t]&&(0,r.default)(e.domListeners[t],(function(e,n){!function(e,t){for(var n=(e.parentNode||document).querySelectorAll(t)||[],r=n.length;r--;)if(n[r]==e)return!0;return!1}(i,n)?"window"===n&&(0,r.default)(e,(function(e,t){e(o)})):(0,r.default)(e,(function(e,n){"click"===t&&"A"===i.nodeName?function(e,t,n){var r,o;if(void 0!==t.getAttribute?r=t.getAttribute("target"):t.target&&(r=t.target),"boolean"==typeof(o=n(e))&&!1===o||e.defaultPrevented||!1===e.returnValue)return e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1;if("_blank"!==r&&"blank"!==r&&!e.metaKey&&!t.hasAttribute("download")&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1,t.href&&"#"!==t.href&&t.href!==window.location+"#"))if(void 0!==o){if(navigator&&navigator.sendBeacon)return void(window.location=t.href);o.then((function(){window.location=t.href})).catch((function(e){window.location=t.href}))}else setTimeout((function(){window.location=t.href}),500)}(o,i,e):"submit"===t&&"FORM"===i.nodeName?function(e,t,n){var r=n(e);if("boolean"==typeof r&&!1===r||e.defaultPrevented||!1===e.returnValue)return e.preventDefault&&e.preventDefault(),e.returnValue=!1,!1;if(e.preventDefault&&e.preventDefault(),e.returnValue=!1,void 0!==r){if(navigator&&navigator.sendBeacon)return void t.submit();r.then((function(){t.submit()})).catch((function(e){t.submit()}))}else setTimeout((function(){t.submit()}),500)}(o,i,e):e(o)}))}))}}return e.domListeners=e.domListeners||{},t.prototype.on=function(t,r){var o=this;return 2!==arguments.length||"string"!=typeof t||"function"!=typeof r?this:(void 0===e.domListeners[t]&&(i(t,n(t)),e.domListeners[t]={}),e.domListeners[t][o.selector]=e.domListeners[t][o.selector]||[],e.domListeners[t][o.selector].push(r),o)},t.prototype.once=function(e,t){var n=this;function r(){return n.off(e,r),t.apply(n,arguments)}return r.fn=t,n.on(e,r),n},t.prototype.off=function(t,n){var o=this,i=[];if(2===arguments.length)(0,r.default)(e.domListeners[t][o.selector],(function(e,t){e!==n&&e.fn!==n&&i.push(e)})),e.domListeners[t][o.selector]=i;else if(1===arguments.length)try{delete e.domListeners[t][o.selector]}catch(n){e.domListeners[t][o.selector]=[]}else(0,r.default)(e.domListeners,(function(t,n){try{delete e.domListeners[n][o.selector]}catch(t){e.domListeners[n][o.selector]=function(){}}}));return o},t}},function(e,t,n){var r=n(0);n(1),e.exports=function(e){var t=[];return r(e,(function(e,n){"string"!=typeof e&&(e=JSON.stringify(e)),t.push(n+"="+encodeURIComponent(e))})),t.join("&")}},function(e,t){e.exports=function(e){for(var t,n={},r=/\+/g,o=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(r," "))},s=e.split("?")[1];t=o.exec(s);)n[i(t[1])]=i(t[2]);return n}},function(e,t,n){(function(t){(function(t){var r,o=t.Keen||void 0,i=n(0),s=n(1),a=n(42),c=n(41),u=n(8);function l(e){if(this instanceof l==0)return new l(e);this.configure(e),l.debug&&this.on("error",l.log),this.emit("ready"),l.emit("client",this)}function d(e){return void 0!==e}o&&void 0===o.resources&&(l.legacyVersion=o),u(l),u(l.prototype),s(l,{debug:!1,enabled:!0,loaded:!1,version:"__VERSION__"}),l.helpers=l.helpers||{},l.resources=l.resources||{},s(l.resources,{base:"{protocol}://{host}",version:"{protocol}://{host}/3.0",projects:"{protocol}://{host}/3.0/projects",projectId:"{protocol}://{host}/3.0/projects/{projectId}",events:"{protocol}://{host}/3.0/projects/{projectId}/events",queries:"{protocol}://{host}/3.0/projects/{projectId}/queries"}),l.utils=l.utils||{},s(l.utils,{each:i,extend:s,parseParams:a,serialize:c}),l.extendLibrary=function(e,t){var n=o||t;return d(n)&&d(n.resources)&&(i(n,(function(t,n){"object"==typeof t?(e[n]=e[n]||{},s(e[n],t)):e[n]=e[n]||t})),s(e.prototype,n.prototype)),e},l.log=function(e){l.debug&&"object"==typeof console&&console.log("[Keen]",e)},l.noConflict=function(){return void 0!==t.Keen&&(t.Keen=l.legacyVersion||o),l},l.ready=function(e){l.loaded?e():l.once("ready",e)},l.prototype.configure=function(e){var t=e||{};return this.config=this.config||{projectId:void 0,writeKey:void 0,host:"api.keen.io",protocol:"https",requestType:"jsonp",resources:s({},l.resources)},"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1&&(t.protocol=document.location.protocol.replace(":","")),t.host&&t.host.replace(/.*?:\/\//g,""),s(this.config,t),this},l.prototype.masterKey=function(e){return arguments.length?(this.config.masterKey=e?String(e):null,this):this.config.masterKey},l.prototype.projectId=function(e){return arguments.length?(this.config.projectId=e?String(e):null,this):this.config.projectId},l.prototype.resources=function(e){if(!arguments.length)return this.config.resources;var t=this;return"object"==typeof e&&i(e,(function(e,n){t.config.resources[n]=e||null})),t},l.prototype.url=function(e){var t,n=Array.prototype.slice.call(arguments,1),r=this.config.resources.base||"{protocol}://{host}";return t=e&&"string"==typeof e?this.config.resources[e]?this.config.resources[e]:r+e:r,i(this.config,(function(e,n){"object"!=typeof e&&(t=t.replace("{"+n+"}",e))})),i(n,(function(e,n){"string"==typeof e?t+="/"+e:"object"==typeof e&&(t+="?",i(e,(function(e,n){t+=n+"="+e+"&"})),t=t.slice(0,-1))})),t},r=function(){l.loaded=!0,l.emit("ready")},l.loaded||"undefined"==typeof document?r():(null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e,!1),document.readyState="complete"}),!1),document.readyState="loading"),function e(t){/in/.test(document.readyState)?setTimeout((function(){e(t)}),9):t()}(r)),e.exports=l}).call(this,"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{})}).call(this,n(4))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeenTracking=t.Keen=t.keenGlobals=void 0;var r=O(n(9)),o=O(n(0)),i=O(n(1)),s=n(40),a=n(39),c=n(31),u=n(15),l=n(30),d=n(29),f=n(28),p=n(27),h=n(10),y=n(26),v=n(12),m=n(25),g=n(24),b=n(11),w=n(23),E=n(14),_=n(21),k=n(20),x=n(17),T=n(16);function O(e){return e&&e.__esModule?e:{default:e}}(0,i.default)(r.default.prototype,{recordEvent:a.recordEvent,recordEvents:a.recordEvents}),(0,i.default)(r.default.prototype,{deferEvent:c.deferEvent,deferEvents:c.deferEvents,queueCapacity:c.queueCapacity,queueInterval:c.queueInterval,recordDeferredEvents:c.recordDeferredEvents,setOptOut:x.setOptOut}),(0,i.default)(r.default.prototype,{extendEvent:u.extendEvent,extendEvents:u.extendEvents});var A=(0,l.initAutoTrackingCore)(r.default);(0,i.default)(r.default.prototype,{initAutoTracking:A}),(0,i.default)(r.default.helpers,{getBrowserProfile:d.getBrowserProfile,getDatetimeIndex:f.getDatetimeIndex,getDomainName:p.getDomainName,getDomNodePath:h.getDomNodePath,getDomNodeProfile:y.getDomNodeProfile,getScreenProfile:v.getScreenProfile,getScrollState:m.getScrollState,getUniqueId:g.getUniqueId,getWindowProfile:b.getWindowProfile});var S=(0,s.listenerCore)(r.default);(0,i.default)(r.default.utils,{cookie:w.cookie,deepExtend:E.deepExtend,listener:S,serializeForm:_.serializeForm,timer:k.timer}),r.default.listenTo=function(e){(0,o.default)(e,(function(e,t){var n=t.split(" "),r=n[0],o=n.slice(1,n.length).join(" ");return S(o).on(r,e)}))},t.keenGlobals=void 0,"undefined"!=typeof webpackKeenGlobals&&(t.keenGlobals=webpackKeenGlobals),T.isLocalStorageAvailable&&localStorage.getItem("optout")&&(r.default.optedOut=!0),"1"!==navigator.doNotTrack&&"yes"!==navigator.doNotTrack||(r.default.doNotTrack=!0);var C=t.Keen=r.default.extendLibrary(r.default);t.KeenTracking=C,t.default=C},function(e,t,n){e.exports=n(44)}])},e.exports=t()},17563:(e,t,n)=>{"use strict";const r=n(70610),o=n(44020),i=n(80500),s=n(92806);function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function u(e,t){return t.decode?o(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function d(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function f(e){const t=(e=d(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const o="string"==typeof n&&n.includes(e.arrayFormatSeparator),i="string"==typeof n&&!o&&u(n,e).includes(e.arrayFormatSeparator);n=i?u(n,e):n;const s=o||i?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);r[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const o of e.split("&")){if(""===o)continue;let[e,s]=i(t.decode?o.replace(/\+/g," "):o,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:u(s,t),n(u(e,t),s,r)}for(const e of Object.keys(r)){const n=r[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else r[e]=p(n,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=l(n):e[t]=n,e}),Object.create(null))}t.extract=f,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const o=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[c(t,e),"[",o,"]"].join("")]:[...n,[c(t,e),"[",c(o,e),"]=",c(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[c(t,e),"[]"].join("")]:[...n,[c(t,e),"[]=",c(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[c(t,e),"=",c(r,e)].join("")]:[[n,c(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,c(t,e)]:[...n,[c(t,e),"=",c(r,e)].join("")]}}(t),o={};for(const t of Object.keys(e))n(t)||(o[t]=e[t]);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((n=>{const o=e[n];return void 0===o?"":null===o?c(n,t):Array.isArray(o)?o.reduce(r(n),[]).join("&"):c(n,t)+"="+c(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:h(f(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:u(r,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=d(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),s=Object.assign(i,e.query);let a=t.stringify(s,n);a&&(a=`?${a}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${c(e.fragmentIdentifier,n)}`),`${r}${a}${u}`},t.pick=(e,n,r)=>{r=Object.assign({parseFragmentIdentifier:!0},r);const{url:o,query:i,fragmentIdentifier:a}=t.parseUrl(e,r);return t.stringifyUrl({url:o,query:s(i,n),fragmentIdentifier:a},r)},t.exclude=(e,n,r)=>{const o=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,o,r)}},57129:(e,t)=>{"use strict";var n=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var r,i,s=[];for(i in"string"!=typeof t&&(t="?"),e)if(n.call(e,i)){if((r=e[i])||null!=r&&!isNaN(r)||(r=""),i=o(i),r=o(r),null===i||null===r)continue;s.push(i+"="+r)}return s.length?t+s.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,o={};t=n.exec(e);){var i=r(t[1]),s=r(t[2]);null===i||null===s||i in o||(o[i]=s)}return o}},47418:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},80500:e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},70610:e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},84564:(e,t,n)=>{"use strict";var r=n(47418),o=n(57129),i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,a=/^[a-zA-Z]:/,c=new RegExp("^[\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF]+");function u(e){return(e||"").toString().replace(c,"")}var l=[["#","hash"],["?","query"],function(e,t){return p(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function f(e){var t,r=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},o={},s=typeof(e=e||r);if("blob:"===e.protocol)o=new y(unescape(e.pathname),{});else if("string"===s)for(t in o=new y(e,{}),d)delete o[t];else if("object"===s){for(t in e)t in d||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=i.test(e.href))}return o}function p(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function h(e,t){e=u(e),t=t||{};var n,r=s.exec(e),o=r[1]?r[1].toLowerCase():"",i=!!r[2],a=!!r[3],c=0;return i?a?(n=r[2]+r[3]+r[4],c=r[2].length+r[3].length):(n=r[2]+r[4],c=r[2].length):a?(n=r[3]+r[4],c=r[3].length):n=r[4],"file:"===o?c>=2&&(n=n.slice(2)):p(o)?n=r[4]:o?i&&(n=n.slice(2)):c>=2&&p(t.protocol)&&(n=r[4]),{protocol:o,slashes:i||p(o),slashesCount:c,rest:n}}function y(e,t,n){if(e=u(e),!(this instanceof y))return new y(e,t,n);var i,s,c,d,v,m,g=l.slice(),b=typeof t,w=this,E=0;for("object"!==b&&"string"!==b&&(n=t,t=null),n&&"function"!=typeof n&&(n=o.parse),i=!(s=h(e||"",t=f(t))).protocol&&!s.slashes,w.slashes=s.slashes||i&&t.slashes,w.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||a.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!p(w.protocol)))&&(g[3]=[/(.*)/,"pathname"]);E<g.length;E++)"function"!=typeof(d=g[E])?(c=d[0],m=d[1],c!=c?w[m]=e:"string"==typeof c?~(v=e.indexOf(c))&&("number"==typeof d[2]?(w[m]=e.slice(0,v),e=e.slice(v+d[2])):(w[m]=e.slice(v),e=e.slice(0,v))):(v=c.exec(e))&&(w[m]=v[1],e=e.slice(0,v.index)),w[m]=w[m]||i&&d[3]&&t[m]||"",d[4]&&(w[m]=w[m].toLowerCase())):e=d(e,w);n&&(w.query=n(w.query)),i&&t.slashes&&"/"!==w.pathname.charAt(0)&&(""!==w.pathname||""!==t.pathname)&&(w.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,o=n[r-1],i=!1,s=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),s++):s&&(0===r&&(i=!0),n.splice(r,1),s--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(w.pathname,t.pathname)),"/"!==w.pathname.charAt(0)&&p(w.protocol)&&(w.pathname="/"+w.pathname),r(w.port,w.protocol)||(w.host=w.hostname,w.port=""),w.username=w.password="",w.auth&&(d=w.auth.split(":"),w.username=d[0]||"",w.password=d[1]||""),w.origin="file:"!==w.protocol&&p(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString()}y.prototype={set:function(e,t,n){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||o.parse)(t)),i[e]=t;break;case"port":i[e]=t,r(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":if(t){var s="pathname"===e?"/":"#";i[e]=t.charAt(0)!==s?s+t:t}else i[e]=t;break;default:i[e]=t}for(var a=0;a<l.length;a++){var c=l[a];c[4]&&(i[c[1]]=i[c[1]].toLowerCase())}return i.origin="file:"!==i.protocol&&p(i.protocol)&&i.host?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes||p(n.protocol)?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}},y.extractProtocol=h,y.location=f,y.trimLeft=u,y.qs=o,e.exports=y}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n(12096)})();